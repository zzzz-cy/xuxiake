{"version":3,"file":"hooks.js","sources":["../../src/drawer/hooks.ts"],"sourcesContent":["import { computed, ref } from 'vue';\nimport { Styles } from '../common';\nimport { getSizeDraggable, calcMoveSize } from '../_common/js/drawer/utils';\nimport type { TdDrawerProps } from './type';\n\nexport const useDrag = (props: TdDrawerProps) => {\n  // 以下为拖拽改变抽屉大小相关 可以抽成hooks\n  const isSizeDragging = ref(false);\n  const draggedSizeValue = ref<string>(null);\n\n  const enableDrag = () => {\n    // mousedown绑定mousemove和mouseup事件\n    document.addEventListener('mouseup', handleMouseup, true);\n    document.addEventListener('mousemove', handleMousemove, true);\n    isSizeDragging.value = true;\n  };\n\n  const handleMouseup = () => {\n    document.removeEventListener('mouseup', handleMouseup, true);\n    document.removeEventListener('mousemove', handleMousemove, true);\n    isSizeDragging.value = false;\n  };\n\n  const handleMousemove = (e: MouseEvent) => {\n    // 鼠标移动时计算draggedSizeValue的值\n    const { x, y } = e;\n    const maxHeight = document.documentElement.clientHeight;\n    const maxWidth = document.documentElement.clientWidth;\n    const offsetHeight = 8;\n    const offsetWidth = 8;\n    // x 轴方向使用最大宽度，y轴方向使用最大高度\n    const max = props.placement === 'left' || props.placement === 'right' ? maxWidth : maxHeight;\n    // x 轴方向使用默认最小宽度，y轴方向使用默认最小高度\n    const min = props.placement === 'left' || props.placement === 'right' ? offsetWidth : offsetHeight;\n    const { allowSizeDraggable, max: limitMax, min: limitMin } = getSizeDraggable(props.sizeDraggable, { max, min });\n\n    // 不支持拖拽就直接返回\n    if (!allowSizeDraggable || !isSizeDragging.value) return;\n\n    const moveSize = calcMoveSize(props.placement, {\n      x,\n      y,\n      maxWidth,\n      maxHeight,\n      max: limitMax,\n      min: limitMin,\n    });\n\n    if (typeof moveSize === 'undefined') return;\n\n    draggedSizeValue.value = `${moveSize}px`;\n    props.onSizeDragEnd?.({\n      e,\n      size: moveSize,\n    });\n  };\n\n  const draggableLineStyles = computed(() => {\n    // 设置拖拽control的样式\n    const isHorizontal = ['right', 'left'].includes(props.placement);\n    const oppositeMap = {\n      left: 'right',\n      right: 'left',\n      top: 'bottom',\n      bottom: 'top',\n    };\n    return {\n      zIndex: 1,\n      position: 'absolute',\n      background: 'transparent',\n      [oppositeMap[props.placement]]: 0,\n      width: isHorizontal ? '16px' : '100%',\n      height: isHorizontal ? '100%' : '16px',\n      cursor: isHorizontal ? 'col-resize' : 'row-resize',\n    } as Styles;\n  });\n\n  return { draggedSizeValue, enableDrag, draggableLineStyles };\n};\n"],"names":["useDrag","props","isSizeDragging","ref","draggedSizeValue","enableDrag","document","addEventListener","handleMouseup","handleMousemove","value","removeEventListener","e","_props$onSizeDragEnd","x","y","maxHeight","documentElement","clientHeight","maxWidth","clientWidth","offsetHeight","offsetWidth","max","placement","min","_getSizeDraggable","getSizeDraggable","sizeDraggable","allowSizeDraggable","limitMax","limitMin","moveSize","calcMoveSize","onSizeDragEnd","call","size","draggableLineStyles","computed","isHorizontal","includes","oppositeMap","left","right","top","bottom","_defineProperty","zIndex","position","background"],"mappings":"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"}